#!/bin/bash\n# Archive test results before project teardown\n\nproject_name=\"$1\"\nframework_path=\"/Users/simonjanke/Projects/cortex-test-framework\"\ntest_project_path=\"$framework_path/test-projects/$project_name\"\narchive_path=\"$framework_path/test-results/archived\"\n\necho \"ğŸ“¦ Archiving test results for project: $project_name\"\n\nif [ ! -d \"$test_project_path\" ]; then\n    echo \"âŒ Error: Test project '$project_name' not found\"\n    exit 1\nfi\n\n# Create archive directory\nmkdir -p \"$archive_path\"\n\n# Create timestamped archive directory\narchive_dir=\"$archive_path/$project_name-$(date +%Y%m%d_%H%M%S)\"\nmkdir -p \"$archive_dir\"\n\necho \"  ğŸ“ Archive directory: $archive_dir\"\n\n# Archive test results\nif [ -d \"$test_project_path/results\" ]; then\n    cp -r \"$test_project_path/results\" \"$archive_dir/\"\n    echo \"  âœ… Test results archived\"\nelse\n    echo \"  âš ï¸  No test results found to archive\"\nfi\n\n# Archive test configuration\nif [ -f \"$test_project_path/test-project.yaml\" ]; then\n    cp \"$test_project_path/test-project.yaml\" \"$archive_dir/\"\n    echo \"  âœ… Test configuration archived\"\nfi\n\n# Archive test data\nif [ -d \"$test_project_path/test-data\" ]; then\n    cp -r \"$test_project_path/test-data\" \"$archive_dir/\"\n    echo \"  âœ… Test data archived\"\nfi\n\n# Archive templates used\nif [ -d \"$test_project_path/templates\" ]; then\n    cp -r \"$test_project_path/templates\" \"$archive_dir/\"\n    echo \"  âœ… Templates archived\"\nfi\n\n# Create archive summary\ncat > \"$archive_dir/archive-summary.md\" << EOF\n# Test Project Archive Summary\n\n**Project**: $project_name\n**Archived**: $(date -Iseconds)\n**Original Path**: $test_project_path\n\n## Archived Contents\n\n### Test Results\n$([ -d \"$archive_dir/results\" ] && echo \"âœ… Test results preserved\" || echo \"âŒ No test results found\")\n\n### Test Configuration\n$([ -f \"$archive_dir/test-project.yaml\" ] && echo \"âœ… Project configuration preserved\" || echo \"âŒ No configuration found\")\n\n### Test Data\n$([ -d \"$archive_dir/test-data\" ] && echo \"âœ… Test data preserved\" || echo \"âŒ No test data found\")\n\n### Templates\n$([ -d \"$archive_dir/templates\" ] && echo \"âœ… Templates preserved\" || echo \"âŒ No templates found\")\n\n## Archive Statistics\n\n- **Total Files**: $(find \"$archive_dir\" -type f | wc -l)\n- **Archive Size**: $(du -sh \"$archive_dir\" | cut -f1)\n- **Test Reports**: $(find \"$archive_dir/results\" -name \"*-test-*.md\" 2>/dev/null | wc -l)\n\n## Test Results Summary\n\nEOF\n\n# Add test results summary if available\nif [ -d \"$archive_dir/results\" ]; then\n    for report in \"$archive_dir/results\"/*-test-*.md; do\n        if [ -f \"$report\" ]; then\n            report_name=$(basename \"$report\")\n            echo \"### $report_name\" >> \"$archive_dir/archive-summary.md\"\n            \n            # Extract test summary if available\n            if grep -q \"Test Summary:\" \"$report\"; then\n                test_result=$(grep \"Test Summary:\" \"$report\" | sed 's/.*Test Summary: //')\n                echo \"- **Result**: $test_result\" >> \"$archive_dir/archive-summary.md\"\n            fi\n            \n            if grep -q \"Overall Assessment\" \"$report\"; then\n                assessment=$(grep -A1 \"Overall Assessment\" \"$report\" | tail -1 | sed 's/^[[:space:]]*//')\n                echo \"- **Assessment**: $assessment\" >> \"$archive_dir/archive-summary.md\"\n            fi\n            \n            echo \"\" >> \"$archive_dir/archive-summary.md\"\n        fi\n    done\nfi\n\ncat >> \"$archive_dir/archive-summary.md\" << EOF\n\n---\n*Archived by Cortex Test Framework | $(date -Iseconds)*\nEOF\n\n# Update archive index\narchive_index=\"$archive_path/archive-index.md\"\nif [ ! -f \"$archive_index\" ]; then\n    cat > \"$archive_index\" << EOF\n# Test Project Archive Index\n\n*Historical record of all test project archives*\n\n## Archived Projects\n\nEOF\nfi\n\n# Add entry to archive index\necho \"- **$project_name** - Archived: $(date -Iseconds) - [[./$project_name-$(date +%Y%m%d_%H%M%S)/archive-summary.md|Summary]]\" >> \"$archive_index\"\n\necho \"âœ… Test results archived successfully\"\necho \"ğŸ“ Archive location: $archive_dir\"\necho \"ğŸ“„ Archive summary: $archive_dir/archive-summary.md\"\necho \"ğŸ“‹ Archive index updated: $archive_index\"\n